# Миры

## Предостережение

В этом документе упоминается режим просмотра, но он будет реализован в одной из следующих
итераций.

## Мир

Мир -- набор статей, относящийся к сеттигу. Данная концепция позволяет привести все материалы в
удобный структурированный вид.

Любой пользователь может создать Мир, в этом случае он назначается Мастером этого мира
и может редактировать его Страницы.

## Страница

Страница -- элемент Мира. Каждая страница описывает конкретный компонент. В зависимости от шаблона
Страница содержит различный набор данных.

Каждая страница имеет уникальный идентификатор (uuid), который не зависит от типа шаблона.

Шаблон страницы задаётся в момент её создания и в последствии не может быть изменен.

При создании Страницы:
* Мастер выбирает шаблон
* Мастеру отображаются поля шаблона для заполнения
* Мастер сохраняет Страницу
* Новой странице присваивается уникальный идентификатор

При сохранении страницы в базу данных заносятся только поля, 
которым были фактически присвоены не-пустые значения.

Атрибуты страницы:
* `is_secret` - признак того, что в режиме просмотра страница доступна только Мастеру мира.

Страница представляет собой документ в базе данных MongoDB, таким образом нет нужды поддерживать
фиксированные наборы полей, которые могут меняться в шаблоне. Сама страница содержит только
значение полей, а не их структуру, за это ответственны шаблоны.

Страницы сохраняются в коллекции `pages`.

Пример страницы:

```json
{
  "_id": "object_id",
  "title": "Заголовок страницы",
  "is_secret": false,
  "fields": {
    "field_code": "Значение поля"
  } 
}
```

## Шаблон Страницы

Шаблон -- перечень полей объекта. Не следует путать с шаблоном отображения страницы. 

Все поля в рамках шаблона собраны в группы. Пример нотации шаблона Страницы:

```json
{
  "code": "template_code",
  "name": "Персонаж",
  "field_group": [
    {
      "group_name": "Внешность",
      "fields": [
        /* Здесь перечислены поля */
      ]
    }
  ]
}
```

Шаблоны сохраняются в базе MongoDB в коллекции `page_templates`.

## Поле

Поле -- минимальный структурный элемент страницы.

Возможные типы полей:

* `string` - Поле является строковым, в режиме редактировани Страницы оно представлено
  строковым полем в одну строку
* `text` - Поле является строковым, в режиме редактирования Страницы оно представлено
  текстовым полем в несколько строк
* `object` - ???

Атрибуты поля:
* `is_secret` - данный признак сигнализирует о том, что в режиме просмотра его содержимое 
  отображается только Мастеру мира; в режиме редактирования такие поля помечены особым знаком
